<canvas height=300 width=300 id="slate"></canvas>
<button id="clear">Reset</button>
<button id="easy">Easy</button>
<button id="med">Medium</button>
<button id="hard">Hard</button>

<script>
var c = document.getElementById("slate");
var ctx = c.getContext("2d");

var clr = document.getElementById("clear");
var eas = document.getElementById("easy");
var med = document.getElementById("med");
var hrd = document.getElementById("hard");

var powerups = [];
var paddlev = 0;
var pycor = window.height/2 - 30;

var pxcor = 30;

var aiycor = window.height/2 -30;

var pad = new Image();
pad.src = "paddle.png";

var ball = new Image();
ball.src = "ball.png";

ctx.fillStyle = "#f0f000";
ctx.strokeStyle = "#00f0f0";

var xcor;
var ycor;
var yv = 0;
var xv = 0;

var pscore;
var cscore;

var exist = false;
var run = false;
var difficulty = 1;

var start = function(e){
  e.preventDefault();
  c.setAttribute("width",window.width);
  c.setAttribute("height",window.height);
  if (! exist){
      xcor = window.width - 50;
      ycor = window.height/2;
      yv = -20;
      xv = Math.random() * 40 - 20;
      exist = ! exist;
      run = true;

window.requestAnimationFrame(play);
  }
  if (! run){
run = ! run;
	window.requestAnimationFrame(play);
    
  } 
}

var makePowerUp = function(a,x,y){
	var z = {};
	z["type"] = a;
	z["xcor"] = x;
	z["ycor"] = y;
	return z;
}

var makeRandomLoc = function(a){
	
}

var clear = function(e){
	e.preventDefault();
	exist = false;
	run = false;
	ctx.clearRect(0,0,c.width,c.height);
	window.cancelAnimationFrame(play);
	}

var play = function(){
	ctx.clearRect(0,0,c.width,c.height);
	movePaddle();	
	moveBall();
	//moveAi();
	checkScore();
		if (run){
		window.requestAnimationFrame(play);
	}
}

var movePaddle = function(){
	pycor = pycor + paddlev;
	ctx.drawImage(pad, 30, pycor, 10, 50);
}

var moveBall = function(){
	if ( (xcor < 40 && ycor > aiycor && ycor < aiycor + 30)  || (xcor > window.width - 50 && ycor > pycor && ycor < pycor + 30)) {
		xv *= -1
	}
	if (ycor > window.height || ycor <  0){
		yv  *= -1
	}
	xcor += xv;
	ycor += yv;
	ctx.drawImage(ball, xcor, ycor, 10, 10);
	ctx.drawImage(pad, 30, pycor, 10, 50);
}
	
var checkScore = function(){
	if (xcor > window.width - 30){
		pscore = pscore + 1;
	ballReset()
	}
	if (xcor <  30){
		cscore = cscore + 1;
		ballReset()
	}
}

var ballReset = function(){
	xcor = window.width/2;
	ycor = window.height/2;
	xv = 20 * math.random() - 10;
	yv = 20 * math.random() - 10;
	
		    }

var aiMove = function(){
	var x = aiPredict();
}
		    

var aiPredict = function(){
	if (xv > 0){
	var t = (window.width - 30 - xcor)/xv
	var x = math.abs(t*yv - ycor)%window.height * math.pow(-1, math.floor(math.abs(t*yv - ycor)/window.height)) + window.height*math.floor(math.abs(t-xcor)/window.height);
	}
	if (xv < 0){
	var t = ( window.width - 90 + xcor)/xv
	var x = math.abs(t*yv - ycor)%window.height * math.pow(-1, math.floor(math.abs(t*yv - ycor)/window.height)) + window.height*math.floor(math.abs(t-xcor)/window.height);
	}
	return x 
}



var paddleUpdate = function(e){
	key = e.keyCode;
	if (paddlev == 0){
		paddlev = 10;}
	if (key == 38){
		paddlev = math.abs(paddlev);
	}
	else if (key == 40){
		paddlev = -1 * math.abs(paddlev);
	}
}

var paddleUpdate2 = function(e){
	key = e.keyCode;
	if (key == 38 && paddlev > 0){
		paddlev = 0;
	}
	else if (key == 40 && paddlev < 0){
		paddlev = 0;
	}
}

c.addEventListener("keyup",paddleUpdate2);
c.addEventListener("keydown", paddleUpdate);
eas.addEventListener("click", start);
</script>


